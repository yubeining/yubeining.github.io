---
title: 推荐工程架构
date: 2025-04-19
updated: 2025-04-19
categories: 搜推广
tags:
  - 搜推广
  - 笔记
top: 1
---

混排层架构：
从业务上来说，混排层是对商品的类做加工处理、对算法侧的多路召回、对商品进行重新排序、指定一系列的透出与展示规则 展现在端上完整的商品卡片，包含商卡的图片、标题、销量、前标、氛围等素材

从技术上来说，这些处理流程需要在混排层进行实现 
本质上还是spring这一套东西
通过xml文件管理bean，每个bean的执行是有先后顺序的
每个bean去实现了一个并行/串行的类，整体流程是串行的
具体模块是并行执行的 比如多路召回
整个执行流程顺序：
1、获取用户的信息（用户的行为特征、用户扩展信息）
这部分去给算法召回用，会去做一些过滤
2、多路召回
从算法侧召回，主路召回（整个大底池的商品），广告、秒杀等

如果遇到算法召回失败的情况，我们会去做一个兜底处理
兜底会去存一些之前算法召回但是没有透出的数据（缓存）
查一张算法产出的表，这些商品和用户没有强相关性，
但是是筛选出近一周内点击加购支付比较高的商品

3、截断
这时候召回的商品很多，需要根据一系列规则去进行截断，降低rt

4、补全
包含商卡的图片、标题、销量、前标、氛围等素材
去查一个二方服务

5、排序、定坑、后过滤规则
得到多路召回的商品，请求算法服务，对商品进行打分排序，排出一个喜欢的顺序
有商业化的要求，会对商业化的品进行定坑处理

6、价格计算、二阶段补全
这一阶段去调用价格的二方服务，对价格进行处理
补充一些氛围素材、依赖于之前二方服务，所以放到后面

7、后处理
将处理的数据，以约定好的结构返回给上游进行处理













